<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MetaboSense Algorithm</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        padding: 0;
    }
    .container {
        max-width: 800px;
        margin: 50px auto;
        background-color: #fff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        text-align: justify;
        position: relative;
    }
    h1 {
        color: #333;
        margin-bottom: 20px;
        font-size: 28px;
        text-align: center;
    }
    p {
        color: #666;
        line-height: 1.6;
    }
    .algorithm {
        background-color: #f9f9f9;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
    }
    .algorithm-title {
        font-size: 20px;
        color: #333;
        margin-bottom: 10px;
    }
    .function-name {
        color: #007bff;
        font-weight: bold;
    }
    .function-description {
        color: #666;
    }
    .highlight {
        background-color: #f4f4f4;
        border-left: 4px solid #007bff;
        padding-left: 10px;
        margin-bottom: 10px;
    }
    .note {
        font-style: italic;
        color: #888;
    }
</style>
</head>
<body>
    <div class="container">
        <h1>MetaboSense Algorithm</h1>
        <div class="algorithm">
            <p class="algorithm-title">MetaboSense Algorithm:</p>
            <p class="function-description">Initialize the MetaboSense system.</p>
            <div class="highlight">
                <p><span class="function-name">initialize_system();</span></p>
                <p><span class="function-name">MetaboSenseAlgorithm();</span></p>
            </div>
            
            <div class="highlight">
                <p><span class="function-name">function MetaboSenseAlgorithm() {</p>
                    <p class="function-description">Loop indefinitely for continuous monitoring.</p>
                    <div class="highlight">
                        <p><span class="function-name">while</span> (<span class="function-name">true</span>) {</p>
                    </div>
                    <p class="function-description">Collect sweat sample, measure conductivity and calculate salt level in terms of voltage.</p>
                    <div class="highlight">
                        <p><span class="function-name">    sweat_sample</span> = <span class="function-name">collect_sweat_sample()</span></p>
                       <p><span class="function-name">    conductivity</span> = <span class="function-name">measure_conductivity(sweat_sample)</span></p>
                    </div>
                    
                    <p class="function-description">Process conductivity and handle errors.</p>
            <div class="highlight">
                <p><span class="function-name">    if</span> conductivity is valid:</p>
                <div class="highlight">
                    <p><span class="function-name">        voltage</span> = <span class="function-name">convert_conductivity_to_voltage(conductivity)</span></p>
                    <p><span class="function-name">        if</span> voltage is within 200V to 500V:</p>
                    <div class="highlight">
                        <p><span class="function-name">            glucose_level</span> = <span class="function-name">interpolate_glucose_level(voltage)</span></p>
                        <p><span class="function-name">            send_to_aws(glucose_level)</span></p>
                    </div>
                    <p><span class="function-name">        else:</span></p>
                    <div class="highlight">
                        <p><span class="function-name">            handle_error("Voltage out of range")</span></p>
                    </div>
                </div>
                <p><span class="function-name">    else:</span></p>
                <div class="highlight">
                    <p><span class="function-name">        handle_error("Invalid conductivity")</span></p>
                </div>
            </div>
       
            <p class="function-description">Check for the end condition and break out of the loop if necessary.</p>
            <div class="highlight">
                <p><span class="function-name">    if</span> end_condition:</p>
                <div class="highlight">
                    <p><span class="function-name">        break</span></p>
                </div>
            </div>
            <p><span class="function-name">        }</span></p>
        </div>
        </div>
        <div class="algorithm">
            <p class="algorithm-title">Convert Voltage into Glucose:</p>
            <div class="highlight">
                <p><span class="function-name">function</span> <span class="function-name">interpolate_glucose_level(voltage)</span> {</p>
    
            <div class="highlight">
                <p class="function-description">x_min, x_max, y_min, y_max have minimum voltage, maximum voltage, minimum sugar level and maximum sugar level respectively </p>
                <p><span class="function-name">    x_min, x_max, y_min, y_max</span> = <span class="function-name">200, 500, 20, 1000</span></p>
                <p><span class="function-name">    glucose_level</span> = <span class="function-name">((voltage-x_min)/(x_max-x_min)) * ((y_max-y_min)+y_min)</span></p>
                <p><span class="function-name">    return </span> <span class="function-name">glucose_level</span></p>
            </div>
            <p><span class="function-name">        }</span></p>
        </div>
        </div>

        <div class="algorithm">
            <p class="algorithm-title">Send Glucose Level to AWS and User Data Collection:</p>
            <p class="function-description">Send glucose level to AWS and collect user data.</p>
            <div class="highlight">
                <p><span class="function-name">function</span> <span class="function-name">send_to_aws(glucose_level)</span> {</p>
            
            <p class="function-description">Receive glucose level from AWS and collect user data such as age, race and bmi</p>
            <div class="highlight">
                <p><span class="function-name">    glucose_level</span> = <span class="function-name">receive_glucose_level_from_aws()</span></p>
                <p><span class="function-name">    user_data</span> = <span class="function-name">collect_user_data()</span></p>
            </div>
            <p class="function-description">Validate user data and assess pre-diabetes risk.</p>
            <div class="highlight">
                <p><span class="function-name">    if</span> validate_user_data(user_data):</p>
                <div class="highlight">
                    <p><span class="function-name">        pre_diabetes_risk</span> = <span class="function-name">assess_pre_diabetes_risk(glucose_level, user_data)</span></p>
                    <p><span class="function-name">        display_risk_assessment(pre_diabetes_risk)</span></p>
                </div>
                <p><span class="function-name">    else:</span></p>
                <div class="highlight">
                    <p><span class="function-name">        handle_error("Invalid user data")</span></p>
                </div>
            </div>
            <p><span class="function-name">        }</span></p>
        </div>
        </div>
        
        <p class="note"><b>collect_sweat_sample()</b> represents the step where the sweat sample is collected for analysis.</p>

        <p class="note"><b>measure_conductivity(sweat_sample)</b> measures the conductivity. The conductivity of the sweat is the measure of its ability to conduct the electricity. The electrical conductivity of a solution of an electrolyte is measured by determining the resistance of the solution between two plate electrodes separated by a fixed distance. The conductivity is then converted to a voltage, which is used to interpolate the glucose level.</p>

        <p class="note"><b>convert_conductivity_to_voltage(conductivity)</b> converts into voltage. Arduino UNO gets the analog signal from the electrode and converts into digital form. BME688 and BME280 sensors measures temperature, humidity, air pressure, and gas resistance. Gas resistance can indirectly indicate air quality or detect certain gases in the environment. These sensors are attached with Arduino. The temperature and humidity data are used to compensate for environmental factors affecting electrical conductivity measurements.  Gas resistance data from the BME688 is used to detect changes in air quality, which might affect conductivity. Pressure data is used to account for altitude variations.</p>

        <p class="note"><b>interpolate_glucose_level(voltage)</b> represents the formula for calculating glucose levels.</p>

        <p class="note"><b>The send_to_aws(glucose_level)</b> function would interact with an AWS Lambda function via an API Gateway. The Lambda function would then process and store the glucose level data in a DynamoDB table.</p>

        <p class="note"><b>receive_glucose_level_from_aws()</b> represents the process where the Android application or Webpage retrieves the glucose level data from AWS (Amazon Web Services), which could be via an API (Application Programming Interface) call.</p>

        <p class="note"><b>collect_user_data()</b> is a function where the application collects additional data from the user, like age and race.</p>

        <p class="note"><b>validate_user_data(user_data)</b> ensures that the collected user data is valid and within expected ranges or formats.</p>

        <p class="note"><b>assess_pre_diabetes_risk(glucose_level, user_data)</b> is the function where the glucose level along with user data is processed to assess the risk of pre-diabetes. This could involve a predictive model or an algorithm based on medical guidelines. (Currently the value is calculated by using this given formula: bmi*0.25 + race*0.25 + result*0.25 + age*0.25 which is then converted into percentage)</p>

        <p class="note"><b>display_risk_assessment(pre_diabetes_risk)</b> shows the outcome of the risk assessment to the user through the app's interface.</p>


        <p class="note">Note: The functions and processes described here are intended for illustrative purposes only.</p>
        
    </div>
</body>
</html>
